<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Shop Analytics Dashboard</title>
  <!-- Minimal styling for example -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    /* Basic styling for the sidebar and content */
    body {
      margin: 0;
      font-family: sans-serif;
    }
    .wrapper {
      display: flex;
      min-height: 100vh;
    }
    #sidebar {
      width: 250px;
      background: #343a40;
      color: #fff;
      padding: 15px;
    }
    #sidebar h3 {
      margin: 0 0 1rem;
    }
    #sidebar .nav-link {
      color: #bbb;
      display: block;
      padding: 8px 0;
      text-decoration: none;
    }
    #sidebar .nav-link.active {
      color: #fff;
      font-weight: bold;
    }
    #content {
      flex: 1;
      background: #f8f9fa;
      padding: 20px;
    }
    .page {
      display: none;
    }
    .page.active {
      display: block;
    }
  </style>
</head>
<body>
  <div class="wrapper">
    <!-- Sidebar -->
    <nav id="sidebar">
      <div class="sidebar-header">
        <h3>Shop Analytics</h3>
        <p id="userEmailDisplay" style="font-size: 0.9rem; margin: 0; padding: 0;"></p>
      </div>
      <ul class="list-unstyled components">
        <li>
          <a href="#" class="nav-link active" onclick="showPage('overview')">
            Overview
          </a>
        </li>
        <li>
          <a href="#" class="nav-link" onclick="showPage('account-health')">
            Account Health
          </a>
        </li>
        <li>
          <a href="#" class="nav-link" onclick="showPage('settings')">
            Settings
          </a>
        </li>
        <li>
          <a href="/logout" class="nav-link">Logout</a>
        </li>
      </ul>
    </nav>

    <!-- Page Content -->
    <div id="content">
      <!-- Overview Page -->
      <div id="overview" class="page active">
        <h2>Dashboard Overview</h2>
        <p>Welcome to your dashboard!</p>
      </div>

      <!-- Account Health Page -->
      <div id="account-health" class="page">
        <h2>Account Health</h2>
        <p>Some account health info here...</p>
      </div>

      <!-- Settings Page -->
      <div id="settings" class="page">
        <h2>Settings</h2>
        <p>Settings go here.</p>
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    // Show a particular page and hide the others
    function showPage(pageId) {
      document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
      document.getElementById(pageId).classList.add('active');

      // Update active link
      document.querySelectorAll('#sidebar .nav-link').forEach(link => link.classList.remove('active'));
      const activeLink = [...document.querySelectorAll('#sidebar .nav-link')]
        .find(link => link.getAttribute('onclick')?.includes(pageId));
      if (activeLink) activeLink.classList.add('active');
    }

    // Fetch the logged-in user's email
    fetch('/me')
      .then(res => {
        if (!res.ok) throw new Error('Not logged in');
        return res.json();
      })
      .then(data => {
        // data.email has the user's email from the server
        document.getElementById('userEmailDisplay').textContent = `Logged in as: ${data.email}`;
      })
      .catch(err => {
        console.log('User not logged in or error:', err);
        // If not logged in, you could redirect to /login or show a different message
        document.getElementById('userEmailDisplay').textContent = 'Not logged in';
      });
  </script>
</body>
</html>
